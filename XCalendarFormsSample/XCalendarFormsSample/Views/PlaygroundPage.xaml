<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="XCalendarFormsSample.Views.PlaygroundPage"
    xmlns="http://xamarin.com/schemas/2014/forms"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:xct="http://xamarin.com/schemas/2020/toolkit"
    xmlns:System="clr-namespace:System;assembly=System.Runtime"
    xmlns:xcModels="clr-namespace:XCalendar.Core.Models;assembly=XCalendar.Core"
    xmlns:xcConverters="clr-namespace:XCalendar.Forms.Converters;assembly=XCalendar.Forms"
    xmlns:xc="clr-namespace:XCalendar.Forms.Views;assembly=XCalendar.Forms"
    xmlns:ViewModels="clr-namespace:XCalendarFormsSample.ViewModels"
    x:Name="This"
    Title="Playground"
    x:DataType="{x:Type ViewModels:PlaygroundViewModel}"
    Style="{StaticResource DefaultPageStyle}">

    <ContentPage.Resources>

        <xct:IsNotNullOrEmptyConverter x:Key="IsNotNullOrEmptyConverter"/>

        <xct:InvertedBoolConverter x:Key="InvertedBoolConverter"/>

        <xct:EnumToBoolConverter x:Key="EnumToBoolConverter"/>
        <xct:MultiConverter x:Key="EnumToInvertedBoolConverter">
            <xct:EnumToBoolConverter/>
            <xct:InvertedBoolConverter/>
        </xct:MultiConverter>

        <xct:VariableMultiValueConverter x:Key="AllTrueConverter" ConditionType="All"/>
        <xct:VariableMultiValueConverter x:Key="AnyTrueConverter" ConditionType="Any"/>

        <xcConverters:StringCharLimitConverter x:Key="StringCharLimitConverter"/>
        <xcConverters:EnumToStringConverter x:Key="EnumToStringConverter"/>

        <xct:MultiConverter x:Key="EnumToStringCharLimitConverter">
            <xcConverters:EnumToStringConverter/>
            <xcConverters:StringCharLimitConverter/>
        </xct:MultiConverter>

        <x:Array x:Key="DayNamesMultiConverterParams" Type="{x:Type xct:MultiConverterParameter}">
            <xct:MultiConverterParameter ConverterType="{x:Type xcConverters:StringCharLimitConverter}">
                <xct:MultiConverterParameter.Value>
                    <x:Int32>3</x:Int32>
                </xct:MultiConverterParameter.Value>
            </xct:MultiConverterParameter>
        </x:Array>
    </ContentPage.Resources>

    <StackLayout Spacing="0">
        <Label
            Padding="5"
            FontSize="14"
            BackgroundColor="{StaticResource PrimaryColor}"
            HorizontalTextAlignment="Center"
            Text="Swipe Page To View Calendar"
            TextColor="{StaticResource PrimaryTextColor}"
            VerticalTextAlignment="Center"/>

        <ScrollView HorizontalScrollBarVisibility="Never" Orientation="Horizontal">
            <Grid
                ColumnDefinitions="*,1,*"
                ColumnSpacing="0"
                RowSpacing="0">

                <ScrollView
                    Grid.Column="0"
                    BackgroundColor="{StaticResource ContentBackgroundColor}"
                    Orientation="Vertical"
                    VerticalScrollBarVisibility="Always">
                    <StackLayout Spacing="0">

                        <StackLayout.Resources>
                            <Style CanCascade="True" TargetType="{x:Type Grid}">
                                <Setter Property="Grid.ColumnDefinitions" Value="*,*"/>
                                <Setter Property="HeightRequest" Value="50"/>
                            </Style>
                        </StackLayout.Resources>

                        <Grid>
                            <Label
                                Grid.Column="0"
                                FontSize="{StaticResource SmallFontSize}"
                                HorizontalTextAlignment="Center"
                                Text="NavigatedDate"
                                VerticalTextAlignment="Center"/>
                            <Editor
                                Grid.Column="1"
                                AutoSize="TextChanges"
                                FontSize="{StaticResource SmallFontSize}"
                                HorizontalOptions="Center"
                                Text="{Binding Calendar.NavigatedDate, StringFormat='{0:ddd, MMM d yyy}'}"
                                VerticalOptions="End"/>
                            <DatePicker
                                Grid.Column="1"
                                Date="{Binding Calendar.NavigatedDate}"
                                FontSize="{StaticResource SmallFontSize}"
                                Format="ddd, MMM d yyy"
                                HorizontalOptions="Center"
                                MaximumDate="{x:Static System:DateTime.MaxValue}"
                                MinimumDate="{x:Static System:DateTime.MinValue}"
                                TextColor="Transparent"/>
                        </Grid>

                        <Grid>
                            <Label
                                Grid.Column="0"
                                FontSize="{StaticResource SmallFontSize}"
                                HorizontalTextAlignment="Center"
                                Text="TodayDate"
                                VerticalTextAlignment="Center"/>
                            <Editor
                                Grid.Column="1"
                                AutoSize="TextChanges"
                                FontSize="{StaticResource SmallFontSize}"
                                HorizontalOptions="Center"
                                Text="{Binding Calendar.TodayDate, StringFormat='{0:ddd, MMM d yyy}'}"
                                VerticalOptions="End"/>
                            <DatePicker
                                Grid.Column="1"
                                Date="{Binding Calendar.TodayDate}"
                                FontSize="{StaticResource SmallFontSize}"
                                Format="ddd, MMM d yyy"
                                HorizontalOptions="Center"
                                MaximumDate="{x:Static System:DateTime.MaxValue}"
                                MinimumDate="{x:Static System:DateTime.MinValue}"
                                TextColor="Transparent"/>
                        </Grid>

                        <Grid>
                            <Label
                                Grid.Column="0"
                                FontSize="{StaticResource SmallFontSize}"
                                HorizontalTextAlignment="Center"
                                Text="NavigationLowerBound"
                                VerticalTextAlignment="Center"/>
                            <Editor
                                Grid.Column="1"
                                AutoSize="TextChanges"
                                FontSize="{StaticResource SmallFontSize}"
                                HorizontalOptions="Center"
                                Text="{Binding Calendar.NavigationLowerBound, StringFormat='{0:ddd, MMM d yyy}'}"
                                VerticalOptions="End"/>
                            <DatePicker
                                Grid.Column="1"
                                Date="{Binding Calendar.NavigationLowerBound, StringFormat='{0:ddd, MMM d yyy}'}"
                                FontSize="{StaticResource SmallFontSize}"
                                Format="ddd, MMM d yyy"
                                HorizontalOptions="Center"
                                MaximumDate="{x:Static System:DateTime.MaxValue}"
                                MinimumDate="{x:Static System:DateTime.MinValue}"
                                TextColor="Transparent"/>
                        </Grid>

                        <Grid>
                            <Label
                                Grid.Column="0"
                                FontSize="{StaticResource SmallFontSize}"
                                HorizontalTextAlignment="Center"
                                Text="NavigationUpperBound"
                                VerticalTextAlignment="Center"/>
                            <Editor
                                Grid.Column="1"
                                AutoSize="TextChanges"
                                FontSize="{StaticResource SmallFontSize}"
                                HorizontalOptions="Center"
                                Text="{Binding Calendar.NavigationUpperBound, StringFormat='{0:ddd, MMM d yyy}'}"
                                VerticalOptions="End"/>
                            <DatePicker
                                Grid.Column="1"
                                Date="{Binding Calendar.NavigationUpperBound}"
                                FontSize="{StaticResource SmallFontSize}"
                                Format="ddd, MMM d yyy"
                                HorizontalOptions="Center"
                                MaximumDate="{x:Static System:DateTime.MaxValue}"
                                MinimumDate="{x:Static System:DateTime.MinValue}"
                                TextColor="Transparent"/>
                        </Grid>

                        <Grid>
                            <Label
                                Grid.Column="0"
                                FontSize="{StaticResource SmallFontSize}"
                                HorizontalTextAlignment="Center"
                                Text="SelectedDates"
                                VerticalTextAlignment="Center"/>
                            <CollectionView
                                Grid.Column="1"
                                BackgroundColor="{StaticResource PageBackgroundColor}"
                                HeightRequest="50"
                                ItemSizingStrategy="MeasureFirstItem"
                                ItemsSource="{Binding Calendar.SelectedDates}"
                                WidthRequest="100">
                                <CollectionView.ItemsLayout>
                                    <LinearItemsLayout ItemSpacing="5" Orientation="Vertical"/>
                                </CollectionView.ItemsLayout>
                                <CollectionView.ItemTemplate>
                                    <DataTemplate x:DataType="{x:Type System:DateTime}">
                                        <Label
                                            FontSize="{StaticResource SmallFontSize}"
                                            HorizontalTextAlignment="Center"
                                            Text="{Binding ., StringFormat='{0:ddd, MMM d yyy}'}"/>
                                    </DataTemplate>
                                </CollectionView.ItemTemplate>
                            </CollectionView>
                        </Grid>

                        <Grid>
                            <Label
                                Grid.Column="0"
                                FontSize="{StaticResource SmallFontSize}"
                                HorizontalTextAlignment="Center"
                                Text="SelectionType"
                                VerticalTextAlignment="Center"/>
                            <Label
                                Grid.Column="1"
                                FontSize="{StaticResource SmallFontSize}"
                                HorizontalTextAlignment="Center"
                                Text="{Binding Calendar.SelectionType}"
                                TextColor="{StaticResource TappableSettingTextColor}"
                                VerticalTextAlignment="Center">

                                <Label.GestureRecognizers>
                                    <TapGestureRecognizer Command="{Binding ShowSelectionTypeDialogCommand}"/>
                                </Label.GestureRecognizers>

                            </Label>
                        </Grid>

                        <Grid>
                            <Label
                                Grid.Column="0"
                                FontSize="{StaticResource SmallFontSize}"
                                HorizontalTextAlignment="Center"
                                Text="SelectionAction"
                                VerticalTextAlignment="Center"/>
                            <Label
                                Grid.Column="1"
                                FontSize="{StaticResource SmallFontSize}"
                                HorizontalTextAlignment="Center"
                                Text="{Binding Calendar.SelectionAction}"
                                TextColor="{StaticResource TappableSettingTextColor}"
                                VerticalTextAlignment="Center">

                                <Label.GestureRecognizers>
                                    <TapGestureRecognizer Command="{Binding ShowSelectionActionDialogCommand}"/>
                                </Label.GestureRecognizers>
                                
                            </Label>
                        </Grid>

                        <Grid>
                            <Label
                                Grid.Column="0"
                                FontSize="{StaticResource SmallFontSize}"
                                HorizontalTextAlignment="Center"
                                Text="Forwards&#10;NavigationAmount"
                                VerticalTextAlignment="Center"/>
                            <Editor
                                Grid.Column="1"
                                HorizontalOptions="Center"
                                Keyboard="Numeric"
                                Text="{Binding Calendar.ForwardsNavigationAmount}"
                                VerticalOptions="End"/>
                        </Grid>

                        <Grid>
                            <Label
                                Grid.Column="0"
                                FontSize="{StaticResource SmallFontSize}"
                                HorizontalTextAlignment="Center"
                                Text="Backwards&#10;NavigationAmount"
                                VerticalTextAlignment="Center"/>
                            <Editor
                                Grid.Column="1"
                                HorizontalOptions="Center"
                                Keyboard="Numeric"
                                Text="{Binding Calendar.BackwardsNavigationAmount}"
                                VerticalOptions="End"/>
                        </Grid>

                        <Grid>
                            <Label
                                Grid.Column="0"
                                FontSize="{StaticResource SmallFontSize}"
                                HorizontalTextAlignment="Center"
                                Text="NavigationTimeUnit"
                                VerticalTextAlignment="Center"/>
                            <Label
                                Grid.Column="1"
                                FontSize="{StaticResource SmallFontSize}"
                                HorizontalTextAlignment="Center"
                                Text="{Binding Calendar.NavigationTimeUnit}"
                                TextColor="{StaticResource TappableSettingTextColor}"
                                VerticalTextAlignment="Center">

                                <Label.GestureRecognizers>
                                    <TapGestureRecognizer Command="{Binding ShowNavigationTimeUnitDialogCommand}"/>
                                </Label.GestureRecognizers>
                                
                            </Label>
                        </Grid>

                        <Grid>
                            <Label
                                Grid.Column="0"
                                FontSize="{StaticResource SmallFontSize}"
                                HorizontalTextAlignment="Center"
                                Text="NavigationLoopMode"
                                VerticalTextAlignment="Center"/>
                            <Label
                                Grid.Column="1"
                                FontSize="{StaticResource SmallFontSize}"
                                HorizontalTextAlignment="Center"
                                Text="{Binding Calendar.NavigationLoopMode}"
                                TextColor="{StaticResource TappableSettingTextColor}"
                                VerticalTextAlignment="Center"
                                WidthRequest="125">

                                <Label.GestureRecognizers>
                                    <TapGestureRecognizer Command="{Binding ShowNavigationLoopModeDialogCommand}"/>
                                </Label.GestureRecognizers>
                                
                            </Label>
                        </Grid>

                        <Grid>
                            <Label
                                Grid.Column="0"
                                FontSize="{StaticResource SmallFontSize}"
                                HorizontalTextAlignment="Center"
                                Text="PageStartMode"
                                VerticalTextAlignment="Center"/>
                            <Label
                                Grid.Column="1"
                                FontSize="{StaticResource SmallFontSize}"
                                HorizontalTextAlignment="Center"
                                Text="{Binding Calendar.PageStartMode}"
                                TextColor="{StaticResource TappableSettingTextColor}"
                                VerticalTextAlignment="Center">

                                <Label.GestureRecognizers>
                                    <TapGestureRecognizer Command="{Binding ShowPageStartModeDialogCommand}"/>
                                </Label.GestureRecognizers>
                                
                            </Label>
                        </Grid>

                        <Grid>
                            <Label
                                Grid.Column="0"
                                FontSize="{StaticResource SmallFontSize}"
                                HorizontalTextAlignment="Center"
                                Text="StartOfWeek"
                                VerticalTextAlignment="Center"/>
                            <Label
                                Grid.Column="1"
                                FontSize="{StaticResource SmallFontSize}"
                                HorizontalTextAlignment="Center"
                                Text="{Binding Calendar.StartOfWeek}"
                                TextColor="{StaticResource TappableSettingTextColor}"
                                VerticalTextAlignment="Center">

                                <Label.GestureRecognizers>
                                    <TapGestureRecognizer Command="{Binding ShowStartOfWeekDialogCommand}"/>
                                </Label.GestureRecognizers>
                                
                            </Label>
                        </Grid>

                        <Grid>
                            <Label
                                Grid.Column="0"
                                FontSize="{StaticResource SmallFontSize}"
                                HorizontalTextAlignment="Center"
                                Text="CustomDayNamesOrder"
                                VerticalTextAlignment="Center"/>
                            <Label
                                Grid.Column="1"
                                FontSize="{StaticResource SmallFontSize}"
                                HorizontalTextAlignment="Center"
                                Text="Edit"
                                TextColor="{StaticResource TappableSettingTextColor}"
                                VerticalTextAlignment="Center">

                                <Label.GestureRecognizers>
                                    <TapGestureRecognizer Command="{Binding ShowCustomDayNamesOrderDialogCommand}"/>
                                </Label.GestureRecognizers>
                                
                            </Label>
                        </Grid>

                        <Grid>
                            <Label
                                Grid.Column="0"
                                FontSize="{StaticResource SmallFontSize}"
                                HorizontalTextAlignment="Center"
                                Text="Use&#10;CustomDayNamesOrder"
                                VerticalTextAlignment="Center"/>
                            <Switch
                                Grid.Column="1"
                                HorizontalOptions="Center"
                                IsToggled="{Binding Calendar.UseCustomDayNamesOrder}"/>
                        </Grid>

                        <Grid>
                            <Label
                                Grid.Column="0"
                                FontSize="{StaticResource SmallFontSize}"
                                HorizontalTextAlignment="Center"
                                Text="Rows"
                                VerticalTextAlignment="Center"/>
                            <Editor
                                Grid.Column="1"
                                HorizontalOptions="Center"
                                Keyboard="Numeric"
                                Text="{Binding Calendar.Rows}"
                                VerticalOptions="End"/>
                        </Grid>

                        <Grid>
                            <Label
                                Grid.Column="0"
                                FontSize="{StaticResource SmallFontSize}"
                                HorizontalTextAlignment="Center"
                                Text="AutoRows"
                                VerticalTextAlignment="Center"/>
                            <Switch
                                Grid.Column="1"
                                HorizontalOptions="Center"
                                IsToggled="{Binding Calendar.AutoRows}"/>
                        </Grid>

                        <Grid>
                            <Label
                                Grid.Column="0"
                                FontSize="{StaticResource SmallFontSize}"
                                HorizontalTextAlignment="Center"
                                Text="AutoRowsIsConsistent"
                                VerticalTextAlignment="Center"/>
                            <Switch
                                Grid.Column="1"
                                HorizontalOptions="Center"
                                IsToggled="{Binding Calendar.AutoRowsIsConsistent}"/>
                        </Grid>

                        <Grid>
                            <Label
                                Grid.Column="0"
                                FontSize="{StaticResource SmallFontSize}"
                                HorizontalTextAlignment="Center"
                                Text="NavigationHeight"
                                VerticalTextAlignment="Center"/>
                            <Editor
                                Grid.Column="1"
                                HorizontalOptions="Center"
                                Keyboard="Numeric"
                                Text="{Binding NavigationHeightRequest}"
                                VerticalOptions="End"/>
                        </Grid>

                        <Grid>
                            <Label
                                Grid.Column="0"
                                FontSize="{StaticResource SmallFontSize}"
                                HorizontalTextAlignment="Center"
                                Text="DayNamesHeight"
                                VerticalTextAlignment="Center"/>
                            <Editor
                                Grid.Column="1"
                                HorizontalOptions="Center"
                                Keyboard="Numeric"
                                Text="{Binding DayNamesHeightRequest}"
                                VerticalOptions="End"/>
                        </Grid>

                        <Grid>
                            <Label
                                Grid.Column="0"
                                FontSize="{StaticResource SmallFontSize}"
                                HorizontalTextAlignment="Center"
                                Text="MonthViewHeight"
                                VerticalTextAlignment="Center"/>
                            <Editor
                                Grid.Column="1"
                                HorizontalOptions="Center"
                                Keyboard="Numeric"
                                Text="{Binding MonthViewHeightRequest}"
                                VerticalOptions="End"/>
                        </Grid>

                        <Grid>
                            <Label
                                Grid.Column="0"
                                FontSize="{StaticResource SmallFontSize}"
                                HorizontalTextAlignment="Center"
                                Text="DayHeight"
                                VerticalTextAlignment="Center"/>
                            <Editor
                                Grid.Column="1"
                                HorizontalOptions="Center"
                                Keyboard="Numeric"
                                Text="{Binding DayHeightRequest}"
                                VerticalOptions="End"/>
                        </Grid>

                        <Grid>
                            <Label
                                Grid.Column="0"
                                FontSize="{StaticResource SmallFontSize}"
                                HorizontalTextAlignment="Center"
                                Text="DayWidth"
                                VerticalTextAlignment="Center"/>
                            <Editor
                                Grid.Column="1"
                                HorizontalOptions="Center"
                                Keyboard="Numeric"
                                Text="{Binding DayWidthRequest}"
                                VerticalOptions="End"/>
                        </Grid>

                    </StackLayout>
                </ScrollView>

                <BoxView Grid.Column="1" BackgroundColor="{DynamicResource OutlineColor}"/>

                <StackLayout Grid.Column="2" Spacing="0">

                    <StackLayout
                        BackgroundColor="{StaticResource ContentBackgroundColor}"
                        HeightRequest="55"
                        Orientation="Horizontal">
                        <Label
                            FontSize="16"
                            HorizontalOptions="EndAndExpand"
                            HorizontalTextAlignment="Center"
                            Text="Default Implementation"
                            VerticalTextAlignment="Center"/>
                        <Switch
                            x:Name="SwitchDefaultImplementation"
                            HorizontalOptions="StartAndExpand"
                            IsToggled="True"/>
                    </StackLayout>

                    <BoxView BackgroundColor="{StaticResource SeparatorColor}" HeightRequest="1"/>
                    
                    <xc:CalendarView
                        x:Name="FancyCalendarView"
                        Days="{Binding Calendar.Days}"
                        DaysOfWeek="{Binding Calendar.DayNamesOrder}"
                        DayNamesHeightRequest="{Binding DayNamesHeightRequest}"
                        MonthViewHeightRequest="{Binding MonthViewHeightRequest}"
                        NavigationHeightRequest="{Binding NavigationHeightRequest}"
                        ForwardsArrowCommand="{Binding NavigateCalendarCommand}"
                        BackwardsArrowCommand="{Binding NavigateCalendarCommand}"
                        NavigatedDate="{Binding Calendar.NavigatedDate}">

                        <xc:CalendarView.ForwardsArrowCommandParameter>
                            <x:Int32>1</x:Int32>
                        </xc:CalendarView.ForwardsArrowCommandParameter>

                        <xc:CalendarView.BackwardsArrowCommandParameter>
                            <x:Int32>-1</x:Int32>
                        </xc:CalendarView.BackwardsArrowCommandParameter>

                        <xc:CalendarView.Style>
                            <Style TargetType="{x:Type xc:CalendarView}" BasedOn="{StaticResource DefaultCalendarViewStyle}">

                                <Setter Property="NavigationTemplate">
                                    <ControlTemplate>
                                        <ContentPresenter/>
                                    </ControlTemplate>
                                </Setter>

                                <Setter Property="DayNameTemplate" Value="{x:Null}"/>

                                <Setter Property="DayTemplate">
                                    <DataTemplate x:DataType="{x:Type xcModels:CalendarDay}">
                                        <ContentView>
                                            <xc:CalendarDayView
                                                Style="{StaticResource DefaultDayViewStyle}"
                                                Margin="2.5"
                                                DateTime="{Binding DateTime}"
                                                IsCurrentMonth="{Binding IsCurrentMonth}"
                                                IsToday="{Binding IsToday}"
                                                IsSelected="{Binding IsSelected}"
                                                IsInvalid="{Binding IsInvalid}"
                                                HeightRequest="{Binding BindingContext.DayHeightRequest, Source={x:Reference This}}"
                                                WidthRequest="{Binding BindingContext.DayWidthRequest, Source={x:Reference This}}"/>
                                        </ContentView>
                                    </DataTemplate>
                                </Setter>

                                <Style.Triggers>
                                    <DataTrigger
                                        Binding="{Binding IsToggled, Source={x:Reference SwitchDefaultImplementation}}"
                                        TargetType="{x:Type xc:CalendarView}"
                                        Value="False">

                                        <Setter Property="NavigationTemplate">
                                            <ControlTemplate>
                                                <StackLayout Spacing="0">

                                                    <StackLayout
                                                        Padding="0,5,5,5"
                                                        BackgroundColor="{Binding NavigationBackgroundColor, Source={x:Reference FancyCalendarView}}"
                                                        Orientation="Horizontal">
                                                        <Label
                                                            Margin="15,0,0,0"
                                                            FontAttributes="Bold"
                                                            FontSize="18"
                                                            HorizontalTextAlignment="Center"
                                                            Text="{Binding Calendar.NavigatedDate, StringFormat='{0:MMMM yyy}', Source={x:Reference FancyCalendarView}}"
                                                            TextColor="{Binding NavigationTextColor, Source={x:Reference FancyCalendarView}}"
                                                            VerticalTextAlignment="Center"/>

                                                        <xc:FramedLabel
                                                            Padding="5"
                                                            BackgroundColor="{Binding NavigationArrowBackgroundColor, Source={x:Reference FancyCalendarView}}"
                                                            CornerRadius="{Binding NavigationArrowCornerRadius, Source={x:Reference FancyCalendarView}}"
                                                            FontAttributes="Bold"
                                                            FontSize="30"
                                                            HeightRequest="30"
                                                            HorizontalOptions="EndAndExpand"
                                                            Text="←"
                                                            TextColor="{Binding NavigationArrowColor, Source={x:Reference FancyCalendarView}}"
                                                            VerticalTextAlignment="End"
                                                            WidthRequest="30">

                                                            <xc:FramedLabel.GestureRecognizers>
                                                                <TapGestureRecognizer Command="{Binding NavigateCalendarCommand, Source={x:Reference FancyCalendarView}}" CommandParameter="{Binding Calendar.BackwardsNavigationAmount, Source={x:Reference FancyCalendarView}}"/>
                                                            </xc:FramedLabel.GestureRecognizers>
                                                            
                                                        </xc:FramedLabel>

                                                        <xc:FramedLabel
                                                            Padding="5"
                                                            BackgroundColor="{Binding NavigationArrowBackgroundColor, Source={x:Reference FancyCalendarView}}"
                                                            CornerRadius="{Binding NavigationArrowCornerRadius, Source={x:Reference FancyCalendarView}}"
                                                            FontAttributes="Bold"
                                                            FontSize="30"
                                                            HeightRequest="30"
                                                            Text="→"
                                                            TextColor="{Binding NavigationArrowColor, Source={x:Reference FancyCalendarView}}"
                                                            VerticalTextAlignment="End"
                                                            WidthRequest="30">

                                                            <xc:FramedLabel.GestureRecognizers>
                                                                <TapGestureRecognizer Command="{Binding NavigateCalendarCommand, Source={x:Reference FancyCalendarView}}" CommandParameter="{Binding Calendar.ForwardsNavigationAmount, Source={x:Reference FancyCalendarView}}"/>
                                                            </xc:FramedLabel.GestureRecognizers>
                                                            
                                                        </xc:FramedLabel>

                                                    </StackLayout>

                                                    <BoxView BackgroundColor="{StaticResource SeparatorColor}" HeightRequest="1"/>

                                                    <Label
                                                        Margin="0,0,0,5"
                                                        FontSize="18"
                                                        HorizontalTextAlignment="Center">
                                                        <Label.Style>
                                                            <Style TargetType="{x:Type Label}">
                                                                <Setter Property="TextColor" Value="Black"/>
                                                                <Setter Property="FontAttributes" Value="Bold"/>
                                                                <Setter Property="Text" Value="{Binding Calendar.TodayDate.DayOfWeek, Source={x:Reference FancyCalendarView}, StringFormat='Today is a {0}!'}"/>
                                                                <Style.Triggers>
                                                                    <DataTrigger
                                                                        Binding="{Binding Calendar.TodayDate.DayOfWeek, Source={x:Reference FancyCalendarView}}"
                                                                        TargetType="{x:Type Label}"
                                                                        Value="{x:Static System:DayOfWeek.Monday}">
                                                                        <Setter Property="TextColor" Value="Gray"/>
                                                                        <Setter Property="FontAttributes" Value="Italic"/>
                                                                        <Setter Property="Text" Value="{Binding Calendar.TodayDate.DayOfWeek, Source={x:Reference FancyCalendarView}, StringFormat='Today is a {0}. I hate {0}s.'}"/>
                                                                    </DataTrigger>
                                                                    <DataTrigger
                                                                        Binding="{Binding Calendar.TodayDate.DayOfWeek, Source={x:Reference FancyCalendarView}}"
                                                                        TargetType="{x:Type Label}"
                                                                        Value="{x:Static System:DayOfWeek.Tuesday}">
                                                                        <Setter Property="TextColor" Value="Red"/>
                                                                    </DataTrigger>
                                                                    <DataTrigger
                                                                        Binding="{Binding Calendar.TodayDate.DayOfWeek, Source={x:Reference FancyCalendarView}}"
                                                                        TargetType="{x:Type Label}"
                                                                        Value="{x:Static System:DayOfWeek.Wednesday}">
                                                                        <Setter Property="TextColor" Value="Orange"/>
                                                                    </DataTrigger>
                                                                    <DataTrigger
                                                                        Binding="{Binding Calendar.TodayDate.DayOfWeek, Source={x:Reference FancyCalendarView}}"
                                                                        TargetType="{x:Type Label}"
                                                                        Value="{x:Static System:DayOfWeek.Thursday}">
                                                                        <Setter Property="TextColor" Value="Yellow"/>
                                                                    </DataTrigger>
                                                                    <DataTrigger
                                                                        Binding="{Binding Calendar.TodayDate.DayOfWeek, Source={x:Reference FancyCalendarView}}"
                                                                        TargetType="{x:Type Label}"
                                                                        Value="{x:Static System:DayOfWeek.Friday}">
                                                                        <Setter Property="TextColor" Value="Green"/>
                                                                    </DataTrigger>
                                                                    <DataTrigger
                                                                        Binding="{Binding Calendar.TodayDate.DayOfWeek, Source={x:Reference FancyCalendarView}}"
                                                                        TargetType="{x:Type Label}"
                                                                        Value="{x:Static System:DayOfWeek.Saturday}">
                                                                        <Setter Property="TextColor" Value="Blue"/>
                                                                    </DataTrigger>
                                                                    <DataTrigger
                                                                        Binding="{Binding Calendar.TodayDate.DayOfWeek, Source={x:Reference FancyCalendarView}}"
                                                                        TargetType="{x:Type Label}"
                                                                        Value="{x:Static System:DayOfWeek.Sunday}">
                                                                        <Setter Property="TextColor" Value="#A000A0"/>
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Label.Style>
                                                    </Label>

                                                </StackLayout>
                                            </ControlTemplate>
                                        </Setter>

                                        <Setter Property="DayNameTemplate">
                                            <DataTemplate x:DataType="{x:Type System:DayOfWeek}">
                                                <Label
                                                    FontSize="15"
                                                    HorizontalTextAlignment="Center"
                                                    Text="{Binding ., Converter={StaticResource EnumToStringCharLimitConverter}, ConverterParameter={StaticResource DayNamesMultiConverterParams}}"
                                                    TextColor="{Binding DayNameTextColor, Source={x:Reference FancyCalendarView}}">

                                                    <Label.Style>
                                                        <Style TargetType="{x:Type Label}">
                                                            <Setter Property="FontAttributes" Value="Bold"/>
                                                            <Style.Triggers>
                                                                <DataTrigger
                                                                    Binding="{Binding .}"
                                                                    TargetType="{x:Type Label}"
                                                                    Value="{x:Static System:DayOfWeek.Monday}">
                                                                    <Setter Property="TextColor" Value="Gray"/>
                                                                    <Setter Property="FontAttributes" Value="Italic"/>
                                                                </DataTrigger>
                                                                <DataTrigger
                                                                    Binding="{Binding .}"
                                                                    TargetType="{x:Type Label}"
                                                                    Value="{x:Static System:DayOfWeek.Tuesday}">
                                                                    <Setter Property="TextColor" Value="Red"/>
                                                                </DataTrigger>
                                                                <DataTrigger
                                                                    Binding="{Binding .}"
                                                                    TargetType="{x:Type Label}"
                                                                    Value="{x:Static System:DayOfWeek.Wednesday}">
                                                                    <Setter Property="TextColor" Value="Orange"/>
                                                                </DataTrigger>
                                                                <DataTrigger
                                                                    Binding="{Binding .}"
                                                                    TargetType="{x:Type Label}"
                                                                    Value="{x:Static System:DayOfWeek.Thursday}">
                                                                    <Setter Property="TextColor" Value="Yellow"/>
                                                                </DataTrigger>
                                                                <DataTrigger
                                                                    Binding="{Binding .}"
                                                                    TargetType="{x:Type Label}"
                                                                    Value="{x:Static System:DayOfWeek.Friday}">
                                                                    <Setter Property="TextColor" Value="Green"/>
                                                                </DataTrigger>
                                                                <DataTrigger
                                                                    Binding="{Binding .}"
                                                                    TargetType="{x:Type Label}"
                                                                    Value="{x:Static System:DayOfWeek.Saturday}">
                                                                    <Setter Property="TextColor" Value="Blue"/>
                                                                </DataTrigger>
                                                                <DataTrigger
                                                                    Binding="{Binding .}"
                                                                    TargetType="{x:Type Label}"
                                                                    Value="{x:Static System:DayOfWeek.Sunday}">
                                                                    <Setter Property="TextColor" Value="#A000A0"/>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Label.Style>

                                                </Label>
                                            </DataTemplate>
                                        </Setter>

                                        <Setter Property="DayTemplate">
                                            <DataTemplate x:DataType="{x:Type xcModels:CalendarDay}">
                                                <ContentView>
                                                    <xc:CalendarDayView
                                                        Style="{StaticResource DefaultDayViewStyle}"
                                                        Margin="2.5"
                                                        DateTime="{Binding DateTime}"
                                                        IsCurrentMonth="{Binding IsCurrentMonth}"
                                                        IsToday="{Binding IsToday}"
                                                        IsSelected="{Binding IsSelected}"
                                                        IsInvalid="{Binding IsInvalid}"
                                                        Text="{Binding DateTime, StringFormat='{0:dd}'}"
                                                        HeightRequest="{Binding BindingContext.DayHeightRequest, Source={x:Reference This}}"
                                                        HorizontalOptions="Center"
                                                        VerticalOptions="Center"
                                                        WidthRequest="{Binding BindingContext.DayWidthRequest, Source={x:Reference This}}">

                                                        <xc:CalendarDayView.ControlTemplate>
                                                            <ControlTemplate>
                                                                <Grid>
                                                                    <ContentPresenter Margin="0,0,0,5"/>

                                                                    <Frame
                                                                        Margin="0,0,0,7.5"
                                                                        Padding="0"
                                                                        CornerRadius="100"
                                                                        HasShadow="False"
                                                                        HeightRequest="6"
                                                                        HorizontalOptions="Center"
                                                                        VerticalOptions="End"
                                                                        WidthRequest="20">
                                                                        <Frame.Style>
                                                                            <Style TargetType="{x:Type Frame}">
                                                                                <Setter Property="BackgroundColor" Value="Red"/>
                                                                                <Style.Triggers>
                                                                                    <MultiTrigger TargetType="{x:Type Frame}">
                                                                                        <MultiTrigger.Conditions>
                                                                                            <BindingCondition Binding="{Binding IsSelected, Source={RelativeSource TemplatedParent}}" Value="True"/>
                                                                                            <BindingCondition Binding="{Binding IsCurrentMonth, Source={RelativeSource TemplatedParent}}" Value="True"/>
                                                                                            <BindingCondition Binding="{Binding IsInvalid, Source={RelativeSource TemplatedParent}}" Value="False"/>
                                                                                        </MultiTrigger.Conditions>
                                                                                        <Setter Property="BackgroundColor" Value="#00A900"/>
                                                                                    </MultiTrigger>
                                                                                </Style.Triggers>
                                                                            </Style>
                                                                        </Frame.Style>
                                                                    </Frame>
                                                                </Grid>
                                                            </ControlTemplate>
                                                        </xc:CalendarDayView.ControlTemplate>

                                                    </xc:CalendarDayView>

                                                </ContentView>
                                            </DataTemplate>
                                        </Setter>

                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </xc:CalendarView.Style>

                    </xc:CalendarView>

                </StackLayout>

            </Grid>
        </ScrollView>
    </StackLayout>

</ContentPage>